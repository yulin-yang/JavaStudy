# ä¸€ã€çº¿ç¨‹ç®€ä»‹ 

## 1.å¤šä»»åŠ¡ 

![pic_c993a763.png](./juc.assets/pic_c993a763.png)  
ç°å®ä¸­å¤ªå¤šè¿™æ ·åŒæ—¶åšå¤šä»¶äº‹æƒ…çš„ä¾‹å­äº†ï¼Œçœ‹èµ·æ¥æ˜¯å¤šä¸ªä»»åŠ¡éƒ½åœ¨åšï¼Œå…¶å®æœ¬è´¨ä¸Šæˆ‘ä»¬çš„å¤§è„‘åœ¨åŒä¸€æ—¶é—´ä¾æ—§åªåšäº†ä¸€ä»¶äº‹æƒ…ã€‚

## 2.å¤šçº¿ç¨‹ 

![pic_696336a3.png](juc.assets/pic_696336a3.png)  
åŸæ¥æ˜¯ä¸€æ¡è·¯ï¼Œæ…¢æ…¢å› ä¸ºè½¦å¤ªå¤šäº†ï¼Œé“è·¯é˜»å¡ï¼Œæ•ˆç‡æä½ã€‚

ä¸ºäº†æé«˜ä½¿ç”¨çš„æ•ˆç‡ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨é“è·¯ï¼Œäºæ˜¯åŠ äº†å¤šä¸ªè½¦é“ã€‚ä»æ­¤ï¼Œå¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒé“è·¯é˜»å¡äº†ã€‚  

![pic_2cfaa82d.png](juc.assets/pic_2cfaa82d.png)

## 3.ç¨‹åº.è¿›ç¨‹.çº¿ç¨‹ 

![pic_48f5abf4.png](juc.assets/pic_48f5abf4.png)

## 4.Processä¸Thread 

 *  è¯´èµ·è¿›ç¨‹ï¼Œå°±ä¸å¾—ä¸è¯´ä¸‹ç¨‹åºã€‚ç¨‹åºæ˜¯æŒ‡ä»¤å’Œæ•°æ®çš„æœ‰åºé›†åˆï¼Œå…¶æœ¬èº«æ²¡æœ‰ä»»ä½•è¿è¡Œçš„å«ä¹‰ï¼Œæ˜¯ä¸€ä¸ªé™æ€çš„æ¦‚å¿µã€‚
 *  è€Œè¿›ç¨‹åˆ™æ˜¯æ‰§è¡Œç¨‹åºçš„ä¾æ¬¡æ‰§è¡Œè¿‡ç¨‹ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŠ¨æ€çš„æ¦‚å¿µã€‚æ˜¯ç³»ç»Ÿèµ„æºåˆ†é…çš„å•ä½ã€‚
 *  é€šå¸¸åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­å¯ä»¥åŒ…å«è‹¥å¹²ä¸ªçº¿ç¨‹ï¼Œå½“ç„¶ä¸€ä¸ªè¿›ç¨‹ä¸­è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œä¸ç„¶æ²¡æœ‰å­˜åœ¨çš„æ„ä¹‰ã€‚çº¿ç¨‹æ˜¯CPUè°ƒåº¦å’Œæ‰§è¡Œçš„å•ä½ã€‚
   
    > æ³¨æ„ï¼š 
    > å¾ˆå¤šå¤šçº¿ç¨‹æ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„ï¼ŒçœŸæ­£çš„å¤šçº¿ç¨‹æ˜¯æŒ‡æœ‰å¤šä¸ªcpuï¼Œå³å¤šæ ¸ï¼Œå¦‚æœåŠ¡å™¨ã€‚å¦‚æœæ˜¯æ¨¡æ‹Ÿå‡ºæ¥çš„å¤šçº¿ç¨‹ï¼Œå³åœ¨ä¸€ä¸ªcpuçš„æƒ…å†µä¸‹ï¼Œåœ¨åŒä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œcpuåªèƒ½æ‰§è¡Œä¸€ä¸ªä»£ç ï¼Œå› ä¸ºåˆ‡æ¢çš„å¾ˆå¿«ï¼Œæ‰€ä»¥å°±æœ‰åŒæ—¶æ‰§è¡Œçš„é”™å±€ã€‚

## 5.æ ¸å¿ƒæ¦‚å¿µ 

 *  çº¿ç¨‹å°±æ˜¯ç‹¬ç«‹çš„æ‰§è¡Œè·¯å¾„
 *  åœ¨ç¨‹åºè¿è¡Œæ—¶ï¼Œå³ä½¿æ²¡æœ‰è‡ªå·±åˆ›å»ºçº¿ç¨‹ï¼Œåå°ä¹Ÿä¼šæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œæ¯”å¦‚ä¸»çº¿ç¨‹ï¼ŒGCCçº¿ç¨‹
 *  main()ç§°ä¹‹ä¸ºä¸»çº¿ç¨‹ï¼Œä¸ºç³»ç»Ÿçš„å…¥å£ï¼Œç”¨äºæ‰§è¡Œæ•´ä¸ªç¨‹åº
 *  åœ¨ä¸€ä¸ªè¿›ç¨‹ä¸­ï¼Œå¦‚æœå¼€è¾Ÿäº†å¤šä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹çš„è¿è¡Œæ˜¯ç”±è°ƒåº¦å™¨ï¼ˆcpuï¼‰å®‰æ’è°ƒåº¦çš„ï¼Œè°ƒåº¦å™¨æ˜¯ä¸æ“ä½œç³»ç»Ÿç´§å¯†ç›¸å…³çš„ï¼Œå…ˆåé¡ºåºæ˜¯ä¸èƒ½äººä¸ºå¹²é¢„çš„
 *  å¯¹åŒä¸€ä»½èµ„æºæ“ä½œæ—¶ï¼Œä¼šå­˜åœ¨èµ„æºæŠ¢å¤ºçš„é—®é¢˜ï¼Œéœ€è¦åŠ å…¥å¹¶å‘æ§åˆ¶
 *  çº¿ç¨‹ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ï¼Œå¦‚CPUè°ƒåº¦æ—¶é—´ï¼Œå¹¶å‘æ§åˆ¶å¼€é”€
 *  æ¯ä¸ªçº¿ç¨‹åœ¨è‡ªå·±çš„å·¥ä½œå†…å­˜äº¤äº’ï¼Œå†…å­˜æ§åˆ¶ä¸å½“ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´

# äºŒã€çº¿ç¨‹å®ç° 

## 1.çº¿ç¨‹åˆ›å»ºï¼ˆä¸‰ç§æ–¹æ³•ï¼‰ 

### 1.1ç»§æ‰¿Threadç±»(é‡è¦) 

- è‡ªå®šä¹‰çº¿ç¨‹ç±»ç»§æ‰¿`Thread`ç±»

- é‡å†™`run()`æ–¹æ³•ï¼Œç¼–å†™çº¿ç¨‹æ‰§è¡Œä½“
- åˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œè°ƒç”¨`start()`æ–¹æ³•å¯åŠ¨çº¿ç¨‹

**å®ç°** 

```java
public class Demo1_CreateThread1 extends Thread {

    @Override
    public void run() {

        //runæ–¹æ³•çº¿ç¨‹ä½“
        for (int i = 0; i < 20; i++) {
            System.out.println("æˆ‘åœ¨çœ‹ä»£ç ----" + i);
        }
    }

    public static void main(String[] args) {
        //mainçº¿ç¨‹ï¼Œä¸Šçº¿ç¨‹
        //åˆ›å»ºä¸€ä¸ªçº¿ç¨‹å¯¹è±¡
        Demo1_CreateThread1 testThread = new Demo1_CreateThread1();
        //è°ƒç”¨startï¼ˆï¼‰å¼€å¯çº¿ç¨‹
        testThread.start();
        for (int i = 0; i < 20; i++) {
            System.out.println("æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹----" + i);
        }
    }
}
```

æ€»ç»“ï¼š

çº¿ç¨‹ä¸ä¸€å®šç«‹å³æ‰§è¡Œï¼ŒCPUå®‰æ’è°ƒåº¦ ï¼Œæœ€ç»ˆæ§åˆ¶å°è¾“å‡º`æˆ‘åœ¨çœ‹ä»£ç ----`å’Œ`æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹----`æ˜¯äº¤æ›¿æ‰§è¡Œçš„

![image-20240920175014233](juc.assets/image-20240920175014233.png)

æ¡ˆä¾‹ï¼š(ä¸‹è½½å›¾ç‰‡)

**æ¡ˆä¾‹** 

```java
/**
 * ç»ƒä¹ Threadï¼Œå®ç°å¤šçº¿ç¨‹åŒæ­¥ä¸‹è½½å›¾ç‰‡
 */
public class Demo2_DownloaderImgCase extends Thread {

    private String url;//ç½‘ç»œå›¾ç‰‡åœ°å€
    private String name;//æŠ¥é”™æ‰¥æ–‡ä»¶å

    //æœ‰å‚æ„é€ 
    public Demo2_DownloaderImgCase(String urlï¼Œ String name) {

        this.url = url;
        this.name = name;
    }

    //ä¸‹è½½å›¾ç‰‡çº¿ç¨‹çš„æ‰§è¡Œä½“
    @Override
    public void run() {

        WebDownloader webDownloader = new WebDownloader();
        webDownloader.downloader(urlï¼Œ name);
        System.out.println("ä¸‹è½½äº†æ–‡ä»¶åä¸º:" + name);
    }

    public static void main(String[] args) {

        Demo2_DownloaderImgCase t = new Demo2_DownloaderImgCase("https://img-home.csdnimg.cn/images/20201124032511.png"ï¼Œ "1.png");
        Demo2_DownloaderImgCase t1 = new Demo2_DownloaderImgCase("https://img-home.csdnimg.cn/images/20201124032511.png"ï¼Œ "2.png");
        Demo2_DownloaderImgCase t2 = new Demo2_DownloaderImgCase("https://img-home.csdnimg.cn/images/20201124032511.png"ï¼Œ "3.png");
        t.start();
        t1.start();
        t2.start();
    }
}

//ä¸‹è½½å™¨
class WebDownloader {
   
     
     
    //ä¸‹è½½æ–¹æ³•
    public void downloader(String urlï¼Œ String name) {
   
     
     
        try {
   
     
     
            FileUtils.copyURLToFile(new URL(url)ï¼Œ new File(name));
        } catch (IOException e) {
   
     
     
            e.printStackTrace();
            System.out.println("IOå¼‚å¸¸ï¼Œdownloaderæ–¹æ³•å‡ºç°é—®é¢˜");
        }
    }
}
```

### 1.2å®ç°Runnableæ¥å£ ï¼ˆé‡ç‚¹ï¼‰

æ¨èä½¿ç”¨Runnableå¯¹è±¡ï¼Œå› ä¸ºJavaå•ç»§æ‰¿çš„å±€é™æ€§

è‡ªå®šä¹‰çº¿ç¨‹ç±»å®ç°`Runnable`æ¥å£

å®ç°`run()`æ–¹æ³•ï¼Œç¼–å†™çº¿ç¨‹æ‰§è¡Œä½“

åˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œè°ƒç”¨`start()`æ–¹æ³•å¯åŠ¨å¯¹è±¡

#### å®ç° 

```java
public class Demo3_CreateRunnable implements Runnable {

    @Override
    public void run() {

        //runæ–¹æ³•çº¿ç¨‹ä½“
        for (int i = 0; i < 20; i++) {

            System.out.println("æˆ‘åœ¨çœ‹ä»£ç ----" + i);
        }
    }

    public static void main(String[] args) {

        //åˆ›å»ºrunnableæ¥å£çš„å®ç°ç±»å¯¹è±¡
        Demo3_CreateRunnable testThread = new Demo3_CreateRunnable();
        //åˆ›å»ºçº¿ç¨‹å¯¹è±¡ï¼Œé€šè¿‡çº¿ç¨‹å¯¹è±¡æ¥å¼€å¯æˆ‘ä»¬çš„çº¿ç¨‹ï¼Œä»£ç†
        Thread thread = new Thread(testThread);
        //è°ƒç”¨startï¼ˆï¼‰å¼€å¯çº¿ç¨‹
        thread.start();

        //new Thread(testThread).start();
        for (int i = 0; i < 200; i++) {
   
     
     
            System.out.println("æˆ‘åœ¨å­¦ä¹ å¤šçº¿ç¨‹----" + i);
        }
    }
}
```

#### æ¡ˆä¾‹ 

ç«è½¦ç¥¨:

```java
/**
 * å¤šä¸ªçº¿ç¨‹åŒæ—¶æ“ä½œåŒä¸€ä¸ªå¯¹è±¡  ä¹°ç«è½¦ç¥¨æ¡ˆä¾‹
 */
//å‘ç°é—®é¢˜:å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æºçš„æƒ…å†µä¸‹ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•°æ®ç´Šä¹±
public class Demo4_TrainTicketsCase implements Runnable {
   
     
     

    //ç¥¨æ•°
    private int ticketNums = 10;

    @Override
    public void run() {
   
     
     
        while (true) {
   
     
     
            if (ticketNums <= 0) {
   
     
     
                break;
            }
            //æ•è·å¼‚å¸¸
            try {
   
     
     
                Thread.sleep(200);
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
            System.out.println(Thread.currentThread().getName() + "--->æ‹¿åˆ°äº†ç¬¬" + ticketNums-- + "å¼ ç¥¨");
        }
    }

    public static void main(String[] args) {
   
     
     
        Demo4_TrainTicketsCase ticket = new Demo4_TrainTicketsCase();
        new Thread(ticketï¼Œ "å°çº¢").start();
        new Thread(ticketï¼Œ "è€å¸ˆ").start();
        new Thread(ticketï¼Œ "é»„ç‰›1").start();
        new Thread(ticketï¼Œ "é»„ç‰›2").start();
    }
}
```

é¾Ÿå…”èµ›è·‘:

![pic_8cff0265.png](juc.assets/pic_8cff0265.png)

```java
/**
 * æ¨¡æ‹Ÿé¾Ÿå…”èµ›è·‘
 */
public class Demo5_RaceCase implements Runnable {
   
     
     
    //èƒœåˆ©è€…
    private static String winner;

    @Override
    public void run() {
   
     
     
        for (int i = 0; i <= 100; i++) {
   
     
     
            //æ¨¡æ‹Ÿå…”å­ä¼‘æ¯
            if (Thread.currentThread().getName().equals("å…”å­") && i % 10 == 0) {
   
     
     
                try {
   
     
     
                    Thread.sleep(2);
                } catch (InterruptedException e) {
   
     
     
                    e.printStackTrace();
                }
            }
            //åˆ¤æ–­æ¯”èµ›æ˜¯å¦ç»“æŸ
            boolean flag = gameOver(i);
            //å¦‚æœæ¯”èµ›ç»“æŸï¼Œåœæ­¢ç¨‹åº
            if (flag) {
   
     
     
                break;
            }
            System.out.println(Thread.currentThread().getName() + "--->è·‘äº†" + i + "æ­¥");
        }
    }

    //åˆ¤æ–­æ˜¯å¦å®Œæˆ
    private boolean gameOver(int steps) {
   
     
     
        if (winner != null) {
   
     
     
            return true;
        } else {
   
     
     
            if (steps >= 100) {
   
     
     
                winner = Thread.currentThread().getName();
                System.out.println("winner is " + winner);
                return true;
            }
        }
        return false;
    }

    public static void main(String[] args) {
   
     
     
        Demo5_RaceCase race = new Demo5_RaceCase();
        new Thread(raceï¼Œ "å…”å­").start();
        new Thread(raceï¼Œ "ä¹Œé¾Ÿ").start();
    }
}
```

### 1.3å®ç°Callableæ¥å£ï¼ˆäº†è§£ï¼‰ 

å®ç°Callableæ¥å£ï¼Œéœ€è¦è¿”å›å€¼ç±»å‹

é‡å†™callæ–¹æ³•ï¼Œéœ€è¦æŠ›å‡ºå¼‚å¸¸

åˆ›å»ºç›®æ ‡å¯¹è±¡

åˆ›å»ºæ‰§è¡ŒæœåŠ¡ï¼šExecutorService ser = Executors.newFixedThreadPool(1);

æäº¤æ‰§è¡Œï¼šFuture result1 = ser.submit(11);

è·å–ç»“æœï¼šboolean r1 = result1.get()

å…³é—­æœåŠ¡ï¼šser.shutdownNow();

#### å®ç° 

```java
/**
 * å®ç°Callableæ¥å£
 */
public class Demo6_CreateCallable implements Callable<Boolean> {

    private String url;//ç½‘ç»œå›¾ç‰‡åœ°å€
    private String name;//æŠ¥é”™æ‰¥æ–‡ä»¶å

    //æœ‰å‚æ„é€ 
    public Demo6_CreateCallable(String urlï¼Œ String name) {
        this.url = url;
        this.name = name;
    }

    //ä¸‹è½½å›¾ç‰‡çº¿ç¨‹çš„æ‰§è¡Œä½“
    public Boolean call() throws Exception {
        WebDownloader webDownloader = new WebDownloader();
        webDownloader.downloader(urlï¼Œ name);
        System.out.println("ä¸‹è½½äº†æ–‡ä»¶åä¸º:" + name);
        return true;
    }

    public static void main(String[] args) throws ExecutionExceptionï¼Œ InterruptedException {
        Demo6_CreateCallable c = new Demo6_CreateCallable("https://img-home.csdnimg.cn/images/20201124032511.png"ï¼Œ "1.png");
        Demo6_CreateCallable c1 = new Demo6_CreateCallable("https://img-home.csdnimg.cn/images/20201124032511.png"ï¼Œ "2.png");
        Demo6_CreateCallable c2 = new Demo6_CreateCallable("https://img-home.csdnimg.cn/images/20201124032511.png"ï¼Œ "3.png");
        //åˆ›å»ºæ‰§è¡ŒæœåŠ¡
        ExecutorService ser = Executors.newFixedThreadPool(3);
        //æäº¤æ‰§è¡Œ
        Future<Boolean> r = ser.submit(c);
        Future<Boolean> r1 = ser.submit(c1);
        Future<Boolean> r2 = ser.submit(c2);
        //è·å–ç»“æœ
        boolean res = r.get();
        boolean res1 = r1.get();
        boolean res2 = r2.get();
        //å…³é—­æœåŠ¡
        ser.shutdownNow();
    }
}
//class WebDownloaderåœ¨å‰é¢ä¸‹è½½å›¾ç‰‡å·²ç»å®šä¹‰äº†ï¼Œè¿™é‡Œå°±ä¸ç”¨å†æ¬¡å†™ï¼Œç›´æ¥ä½¿ç”¨å°±å¥½
```

#### å¥½å¤„ 

å¯ä»¥å®šä¹‰è¿”å›å€¼

å¯ä»¥æŠ›å‡ºå¼‚å¸¸

### 1.4Threadå’ŒRunnableå¯¹æ¯” 

ç»§æ‰¿Thredç±»:

 *  å­ç±»ç»§æ‰¿Threadç±»å…·å¤‡å¤šçº¿ç¨‹èƒ½åŠ›
 *  å¯åŠ¨çº¿ç¨‹:å­ç±»å¯¹è±¡.start()
 *  ä¸å»ºè®®ä½¿ç”¨:é¿å…OOPå•ç»§æ‰¿å±€é™æ€§

å®ç°Runnableæ¥å£

 *  å®ç°æ¥å£Runnableå…·æœ‰å¤šçº¿ç¨‹èƒ½åŠ›
 *  å¯åŠ¨çº¿ç¨‹:ä¼ å…¥ç›®æ ‡å¯¹è±¡+Threadå¯¹è±¡.start()
 *  æ¨èä½¿ç”¨:é¿å…å•ç»§æ‰¿å±€é™æ€§ï¼Œçµæ´»æ–¹ä¾¿ï¼Œæ–¹ä¾¿åŒä¸€ä¸ªå¯¹è±¡è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨  
    ![pic_3714c580.png](juc.assets/pic_3714c580.png)

## 2.é™æ€ä»£ç† 

![pic_c9f53004.png](juc.assets/pic_c9f53004.png)

#### å®ç°: ç»“å©šæ¡ˆä¾‹ 

```java
/**
 * é™æ€ä»£ç†:ç»“å©šæ¡ˆä¾‹
 */
public class Demo7_StaticProxy {
   
     
     
    public static void main(String[] args) {
   
     
     
        WeddingCompany weddingCompany = new WeddingCompany(new You());
        weddingCompany.happyMarry();
    }
}

//ç»“å©š
interface Marry {
   
     
     
    void happyMarry();
}

//çœŸå®è§’è‰²:ä½ å»ç»“å©š
class You implements Marry {
   
     
     
    @Override
    public void happyMarry() {
   
     
     
        System.out.println("dorisè¦ç»“å©šäº†ï¼Œè¶…å¼€å¿ƒ");
    }
}

//ä»£ç†è§’è‰²:å¸®åŠ©ä½ ç»“å©š
class WeddingCompany implements Marry {
   
     
     
    private Marry target;//ä»£ç†-->çœŸå®ç›®æ ‡è§’è‰²è§’è‰²ï¼Œå¸®è°ç»“å©š

    public WeddingCompany(Marry target) {
   
     
     
        this.target = target;
    }

    @Override
    public void happyMarry() {
   
     
     
        after();
        this.target.happyMarry();
        before();
    }

    private void after() {
   
     
     
        System.out.println("ç»“å©šä¹‹å‰ï¼Œå¸ƒç½®ç°åœº");
    }

    private void before() {
   
     
     
        System.out.println("ç»“å©šä¹‹åï¼Œæ”¶å°¾æ¬¾");
    }
}
```

ä¼˜åŒ–:ä½¿ç”¨çº¿ç¨‹ï¼ŒLamdaè¡¨è¾¾å¼

```java
/**
 * çº¿ç¨‹ä¸­çš„ä»£ç†æ¨¡å¼
 */
public class Demo8_StaticProxy {
   
     
     
    public static void main(String[] args) {
   
     
     
        new Thread(()-> System.out.println("æˆ‘çˆ±ä½ ")).start();
        new WeddingCompany(new You()).happyMarry();
    }
}
//WeddingCompany...ä¸Šä¸€ä¸ªæ–‡ä»¶å®šä¹‰è¿‡äº†è¿™é‡Œå°±ç›´æ¥ä½¿ç”¨äº†
```

#### æ€»ç»“ 

çœŸå®å¯¹è±¡å’Œä»£ç†å¯¹è±¡éƒ½è¦å®ç°ä¸€ä¸ªæ¥å£  
ä»£ç†å¯¹è±¡è¦ä»£ç†çœŸå®è§’è‰²

#### å¥½å¤„ 

ä»£ç†å¯¹è±¡å¯ä»¥åšå¾ˆå¤šçœŸå®å¯¹è±¡åšä¸äº†çš„äº‹æƒ…  
çœŸå®å¯¹è±¡ä¸“æ³¨åšè‡ªå·±çš„äº‹

## 3.Lamdaè¡¨è¾¾å¼ 

#### ä»‹ç» 

![pic_fb9ea718.png](juc.assets/pic_fb9ea718.png)

 *  Î» å¸Œè…Šå­—æ¯è¡¨ä¸­æ’åºç¬¬åä¸€ä½çš„å­—æ¯ï¼Œè‹±è¯­åç§°ä¸º Lamda
 *  é¿å…åŒ¿åå†…éƒ¨ç±»å®šä¹‰è¿‡å¤š
 *  å…¶å®è´¨å±äºå‡½æ•°å¼ç¼–ç¨‹çš„æ¦‚å¿µ
 *  å»æ‰äº†ä¸€å †æ²¡æœ‰æ„ä¹‰çš„ä»£ç ï¼Œåªç•™ä¸‹æ ¸å¿ƒé€»è¾‘

> (params)-> expression\[è¡¨è¾¾å¼\]
>
> (params) -> statement\[è¯­å¥\]
>
> \[(params)-> \{statements\}

```java
a -> System.out.println("i like lamda-->"+a)
```

new Thread (()->System.out.println(â€œå¤šçº¿ç¨‹å­¦ä¹ ã€‚ã€‚ã€‚ã€‚â€)).start();

ç†è§£Functional Interface (å‡½æ•°å¼æ¥å£) æ˜¯å­¦ä¹ Java8 lamdaè¡¨è¾¾å¼çš„å…³é”®

#### å‡½æ•°å¼æ¥å£çš„å®šä¹‰: 

ä»»ä½•æ¥å£ï¼Œå¦‚æœåªåŒ…å«å”¯ä¸€ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œé‚£ä¹ˆå®ƒå°±æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£.

```java
public interface Runnable{
       
    public abstract void run();
}
```

å¯¹äºå‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡Lamdaè¡¨è¾¾å¼æ¥åˆ›å»ºè¯¥æ¥å£çš„å¯¹è±¡.

#### å®ç°: 

##### æ¡ˆä¾‹1: 

```java
/**
 * æ¨å¯¼lamdaè¡¨è¾¾å¼
 */
public class Demo9_Lamda {
             
    public static void main(String[] args) {
             
        ILike like = new Like();
        like.lamda();
    }
}

// 1.å®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£
interface ILike {
             
    void lamda();
}

// 2.å®ç°ç±»
class Like implements ILike {
             
    @Override
    public void lamda() {
             
        System.out.println("I like lamda");
    }
}
```

ä¼˜åŒ–1ï¼š

```java
public class Demo10_Lamda1 {
   
     
     
    //3. é™æ€å†…éƒ¨ç±»
    static class Like1 implements ILike {
   
     
     
        @Override
        public void lamda() {
   
     
     
            System.out.println("I like lamda1");
        }
    }
    //3.é™æ€å†…éƒ¨ç±»
    public static void main(String[] args) {
   
     
     
        ILike like = new Like1();
        like.lamda();
    }
}
```

ä¼˜åŒ–2ï¼š

```java
public class Demo11_Lamda2 {
   
     
     
    public static void main(String[] args) {
   
     
     
        //4.å±€éƒ¨å†…éƒ¨ç±»
        class Like12 implements ILike {
   
     
     
            @Override
            public void lamda() {
   
     
     
                System.out.println("I like lamda2");
            }
        }
        ILike like = new Like12();
        like.lamda();
    }
}
```

ä¼˜åŒ–3ï¼š

```java
public class Demo12_Lamda3 {
   
     
     
    public static void main(String[] args) {
   
     
     
        //5.åŒ¿åå†…éƒ¨ç±»ï¼Œæ²¡æœ‰ç±»çš„åç§°ï¼Œå¿…é¡»å€ŸåŠ©æ¥å£æˆ–è€…çˆ¶ç±»
        ILike like = new ILike () {
   
     
     
            @Override
            public void lamda() {
   
     
     
                System.out.println("I like lamda3");
            }
        };
        like.lamda();
    }
}
```

æœ€ç»ˆç‰ˆï¼š

```java
public class Demo13_Lamda4 {
   
     
     
    public static void main(String[] args) {
   
     
     
        //6.lamdaç®€åŒ–
        ILike like = () ->{
   
     
     
            System.out.println("I like lamda4");
        };
        like.lamda();
    }
}
```

##### æ¡ˆä¾‹2: 

```java
public class Demo14_LamdaCase2 {
   
     
     
    public static void main(String[] args) {
   
     
     
        // 1.lamda
        ILove love = (int a) -> {
   
     
     
            System.out.println("I love you -->" + a);
        };
        // 2.lamdaç®€åŒ–1.0
        love = (a) -> {
   
     
     
            System.out.println("I love you -->" + a);
        };
        // 3.lamdaç®€åŒ–2.0
        love = a -> {
   
     
     
            System.out.println("I love you -->" + a);
        };
        // 3.lamdaç®€åŒ–3.0
        love = a -> System.out.println("I love you -->" + a);

        /**æ€»ç»“:
         * {}ç®€ç•¥çš„æ¡ä»¶æ˜¯åªèƒ½æœ‰ä¸€è¡Œä»£ç ï¼Œå¤šè¡Œ{}å°±ä¸èƒ½ç®€ç•¥äº†
         * å‰ææ˜¯æ¥å£ä¸ºå‡½æ•°å¼æ¥å£(åªèƒ½æœ‰ä¸€ä¸ªæ–¹æ³•)
         * å¤šä¸ªå‚æ•°ä¹Ÿå¯ä»¥å»æ‰å‚æ•°ç±»å‹ï¼Œè¦å»æ‰å°±éƒ½å»æ‰ï¼Œå¿…é¡»åŠ ä¸Š()
         */

        love.love(520);
    }
}

interface ILove {
   
     
     
    void love(int a);
}
```

# ä¸‰ã€çº¿ç¨‹çŠ¶æ€ 

## ğŸ’1.çº¿ç¨‹äº”å¤§çŠ¶æ€: 

![pic_9b1d0040.png](juc.assets/pic_9b1d0040.png)  
![pic_ca887312.png](juc.assets/pic_ca887312.png)

## ğŸ’2.çº¿ç¨‹æ–¹æ³• 

![pic_abcd979d.png](juc.assets/pic_abcd979d.png)

#### ğŸ2.1åœæ­¢çº¿ç¨‹ 

![pic_de434aa0.png](juc.assets/pic_de434aa0.png)

##### æ¡ˆä¾‹: 

```java
/**
 * æµ‹è¯•stop
 * 1.å»ºè®®çº¿ç¨‹æ­£å¸¸åœæ­¢-->åˆ©ç”¨æ¬¡æ•°ï¼Œä¸å»ºè®®æ­»å¾ªç¯
 * 2.å»ºè®®ä½¿ç”¨æ ‡å¿—ä½-->è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½
 * 3.ä¸è¦ä½¿ç”¨stopæˆ–è€…destroyç­‰è¿‡æ—¶æˆ–è€…JDKä¸å»ºè®®ä½¿ç”¨çš„æ–¹æ³•
 */
public class Demo15_StopThread implements Runnable {
   
     
     
    // 1. è®¾ç½®ä¸€ä¸ªæ ‡å¿—ä½
    private boolean flag = true;

    @Override
    public void run() {
   
     
     
        int i = 0;
        while (flag) {
   
     
     
            System.out.println("run...Thread" + i++);
        }
    }

    // 2. è®¾ç½®ä¸€ä¸ªå…¬å¼€çš„æ–¹æ³•åœæ­¢çº¿ç¨‹ï¼Œè½¬æ¢æ ‡å¿—ä½
    public void stop() {
   
     
     
        this.flag = false;
    }

    public static void main(String[] args) {
   
     
     
        Demo15_StopThread stop = new Demo15_StopThread();
        new Thread(stop).start();
        for (int i = 0; i < 1000; i++) {
   
     
     
            System.out.println("main..." + i);
            if (i == 900) {
   
     
     
                //è°ƒç”¨stop()åˆ‡æ¢æ ‡å¿—ä½ï¼Œè®©çº¿ç¨‹ç»ˆæ­¢
                stop.stop();
                System.out.println("è¯¥çº¿ç¨‹åœæ­¢äº†");
            }
        }
    }
}
```

#### ğŸ2.2çº¿ç¨‹ä¼‘çœ  

![pic_ac8908e2.png](juc.assets/pic_ac8908e2.png)

##### æ¡ˆä¾‹: 

```java
/**
 * æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿ:æ”¾å¤§é—®é¢˜çš„å‘ç”Ÿæ€§
 */
public class Demo16_SleepThread implements Runnable {
   
     
     

    //ç¥¨æ•°
    private int ticketNums = 10;

    @Override
    public void run() {
   
     
     
        while (true) {
   
     
     
            if (ticketNums <= 0) {
   
     
     
                break;
            }
            //æ•è·å¼‚å¸¸
            try {
   
     
     
                Thread.sleep(200);
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
            System.out.println(Thread.currentThread().getName() + "--->æ‹¿åˆ°äº†ç¬¬" + ticketNums-- + "å¼ ç¥¨");
        }
    }

    public static void main(String[] args) {
   
     
     
        Demo4_TrainTicketsCase ticket = new Demo4_TrainTicketsCase();
        new Thread(ticketï¼Œ "å°çº¢").start();
        new Thread(ticketï¼Œ "è€å¸ˆ").start();
        new Thread(ticketï¼Œ "é»„ç‰›1").start();
    }
}
```

```java
/**
 * æ¨¡æ‹Ÿå€’è®¡æ—¶
 */
public class Demo17_SleepThread2 {
   
     
     

    public static void main(String[] args) {
   
     
     
        try {
   
     
     
            tenDown();
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }
    }

    //æ¨¡æ‹Ÿå€’è®¡æ—¶
    public static void tenDown() throws InterruptedException {
   
     
     
        int num = 10;//10ç§’
        while (true) {
   
     
     
            Thread.sleep(1000);
            System.out.println(num--);
            if (num <= 0) {
   
     
     
                break;
            }
        }
    }
}
```

```java
/**
 * æ¯ä¸€ç§’è·å–å½“å‰æ—¶é—´
 */
public class Demo18_SleepThread3 {
   
     
     

    public static void main(String[] args) {
   
     
     
        //è·å–ç³»ç»Ÿå½“å‰æ—¶é—´
        Date startTime = new Date(System.currentTimeMillis());
        while (true) {
   
     
     
            try {
   
     
     
                Thread.sleep(1000);
                //æ›´æ–°ç³»ç»Ÿæ—¶é—´
                System.out.println(new SimpleDateFormat("HH:mm:ss").format(startTime));
                startTime = new Date(System.currentTimeMillis());
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
        }
    }
}
```

#### ğŸ2.3çº¿ç¨‹ç¤¼è®© 

![pic_e2a13f77.png](juc.assets/pic_e2a13f77.png)

##### æ¡ˆä¾‹: 

```java
/**
 * æµ‹è¯•ç¤¼è®©çº¿ç¨‹
 * ç¤¼è®©ä¸ä¸€å®šæˆåŠŸï¼Œçœ‹cpuå¿ƒæƒ…
 */
public class Demo19_YieldThread {
   
     
     
    public static void main(String[] args) {
   
     
     
        MyYeild myYeild = new MyYeild();
        new Thread(myYeildï¼Œ "a").start();
        new Thread(myYeildï¼Œ "b").start();
    }
}

class MyYeild implements Runnable {
   
     
     
    @Override
    public void run() {
   
     
     
        System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹å¼€å§‹æ‰§è¡Œ");
        Thread.yield();//ç¤¼è®©
        System.out.println(Thread.currentThread().getName() + "çº¿ç¨‹åœæ­¢æ‰§è¡Œ");
    }
}
```

#### ğŸ2.4çº¿ç¨‹æ’é˜Ÿ 

![pic_20026afa.png](juc.assets/pic_20026afa.png)

##### æ¡ˆä¾‹: 

```java
/**
 * æµ‹è¯•join
 * æ’é˜Ÿ
 */
public class Demo20_JoinThread implements Runnable {
   
     
     
    @Override
    public void run() {
   
     
     
        for (int i = 0; i < 500; i++) {
   
     
     
            System.out.println("çº¿ç¨‹vip" + i);
        }
    }

    public static void main(String[] args) throws InterruptedException {
   
     
     
        //å¯åŠ¨æˆ‘ä»¬çš„çº¿ç¨‹
        Demo20_JoinThread joinThread = new Demo20_JoinThread();
        Thread thread = new Thread(joinThread);
        thread.start();

        //ä¸»çº¿ç¨‹
        for (int i = 0; i < 500; i++) {
   
     
     
            if (i == 200) {
   
     
     
                thread.join();//æ’é˜Ÿ
            }
            System.out.println("main" + i);
        }
    }
}
```

## ğŸ’3.çº¿ç¨‹çŠ¶æ€è§‚æµ‹ 

![pic_dc01c4f9.png](juc.assets/pic_dc01c4f9.png)

#### å®ç°: 

```java
/**
 * è§‚å¯Ÿæµ‹è¯•çº¿ç¨‹çŠ¶æ€
 */
public class Demo21_ThreadState {
   
     
     
    public static void main(String[] args) throws InterruptedException {
   
     
     
        Thread thread = new Thread(() -> {
   
     
     
            for (int i = 0; i < 5; i++) {
   
     
     
                try {
   
     
     
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
   
     
     
                    e.printStackTrace();
                }
            }
            System.out.println("//");
        });
        //è§‚å¯ŸçŠ¶æ€
        Thread.State state = thread.getState();
        System.out.println(state);
        //è§‚å¯Ÿå¯åŠ¨å
        thread.start();
        state = thread.getState();
        System.out.println(state);//Run
        while (state != Thread.State.TERMINATED) {
   
     
     //åªè¦ç°æˆä¸ç»ˆæ­¢ï¼Œå°±ä¸€ç›´è¾“å‡ºçŠ¶æ€
            Thread.sleep(100);
            state = thread.getState();//æ›´æ–°çº¿ç¨‹çŠ¶æ€
            System.out.println(state);
        }
        //æ­»äº¡åçš„çº¿ç¨‹ä¸èƒ½å†å¯åŠ¨äº†ï¼Œå¯åŠ¨ä¼šæŠ¥å¼‚å¸¸
        //thread.start();
    }
}
```

## ğŸ’4.çº¿ç¨‹ä¼˜å…ˆçº§ 

![pic_ed4138f5.png](juc.assets/pic_ed4138f5.png)

#### å®ç°: 

```java
/**
 * çº¿ç¨‹ä¼˜å…ˆçº§
 */
public class Demo22_ThreadPriority{
   
     
     
    public static void main(String[] args) {
   
     
     
        //ä¸»çº¿ç¨‹é»˜è®¤ä¼˜å…ˆçº§
        System.out.println(Thread.currentThread().getName()+"-->"+Thread.currentThread().getPriority());

        MyPriority myPriority = new MyPriority();
        Thread thread1 = new Thread(myPriority);
        Thread thread2 = new Thread(myPriority);
        Thread thread3 = new Thread(myPriority);
        Thread thread4 = new Thread(myPriority);
        Thread thread5 = new Thread(myPriority);

        //å…ˆè®¾ç½®ä¼˜å…ˆçº§ï¼Œå†å¯åŠ¨
        thread1.start();

        thread2.setPriority(1);
        thread2.start();

        thread3.setPriority(4);
        thread3.start();

        thread4.setPriority(Thread.MAX_PRIORITY);//MAX_PRIORITY=10
        thread4.start();

        thread5.setPriority(8);
        thread5.start();
    }
}
class MyPriority implements Runnable{
   
     
     
    @Override
    public void run() {
   
     
     
        System.out.println(Thread.currentThread().getName()+"-->"+Thread.currentThread().getPriority());
    }
}
```

## ğŸ’5.å®ˆæŠ¤(daemon)çº¿ç¨‹ 

![pic_e9b27a8c.png](juc.assets/pic_e9b27a8c.png)

##### å®ç°: 

```java
/**
 * æµ‹è¯•å®ˆæŠ¤çº¿ç¨‹
 * ä¸Šå¸å®ˆæŠ¤ä½ 
 */
public class Demo23_DaemonThread {
   
     
     
    public static void main(String[] args) {
   
     
     
        God god = new God();
        You you = new You();

        Thread thread = new Thread(god);
        //é»˜è®¤falseè¡¨ç¤ºæ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œæ­£å¸¸çš„çº¿ç¨‹éƒ½æ˜¯ç”¨æˆ·çº¿ç¨‹...
        thread.setDaemon(true);
        //ä¸Šå¸å®ˆæŠ¤çº¿ç¨‹å¯åŠ¨
        thread.start();
        //ä½  ç”¨æˆ·çº¿ç¨‹å¯åŠ¨
        new Thread(you).start();
    }
}

//ä¸Šå¸
class God implements Runnable{
   
     
     
    @Override
    public void run() {
   
     
     
        while (true){
   
     
     
            System.out.println("ä¸Šå¸ä¿ä½‘ç€ä½ ");
        }
    }
}

//ä½ 
class You implements Runnable{
   
     
     
    @Override
    public void run() {
   
     
     
        for (int i = 0; i < 36500; i++) {
   
     
     
            System.out.println("ä½ ä¸€ç”Ÿéƒ½å¼€å¿ƒçš„æ´»ç€");
        }
        System.out.println("====goodbye!world====");
    }
}
```

## å››ã€çº¿ç¨‹åŒæ­¥ 

### ğŸ’1.ä»‹ç» 

\*\*å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªèµ„æº \*\*

![pic_5002e4e3.png](juc.assets/pic_5002e4e3.png)  
![pic_a1293957.png](juc.assets/pic_a1293957.png)  
![pic_5aefd28f.png](juc.assets/pic_5aefd28f.png)  
![pic_d5d6ebc5.png](juc.assets/pic_d5d6ebc5.png)

### ğŸ’2.ä¸å®‰å…¨çš„çº¿ç¨‹æ¡ˆä¾‹ 

```java
//ä¸å®‰å…¨ä¹°ç¥¨
public class Demo24_UnsafeBuyTicket {
   
     
     
    public static void main(String[] args) {
   
     
     
        BuyTicket buyTicket = new BuyTicket();
        new Thread(buyTicketï¼Œ "å¼ ä¸‰").start();
        new Thread(buyTicketï¼Œ "æå››").start();
        new Thread(buyTicketï¼Œ "ç‹äº”").start();
    }
}

class BuyTicket implements Runnable {
   
     
     
    //ç¥¨
    private int ticketNums = 10;
    boolean flag = true;

    @Override
    public void run() {
   
     
     
        //ä¹°ç¥¨
        while (flag) {
   
     
     
            try {
   
     
     
                buy();
            } catch (Exception e) {
   
     
     
                e.printStackTrace();
            }
        }
    }

    //ä¹°ç¥¨
    private void buy() {
   
     
     
        //åˆ¤æ–­æ˜¯å¦æœ‰ç¥¨
        if (ticketNums <= 0) {
   
     
     
            flag = false;
            return;
        }
        //å»¶è¿Ÿ
        try {
   
     
     
            Thread.sleep(1);
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }

        //ä¹°ç¥¨
        System.out.println(Thread.currentThread().getName() + "æ‹¿åˆ°" + ticketNums--);
    }
}
```

```java
/**
 * ä¸å®‰å…¨çš„å–é’±
 */
public class Demo25_UnsafeBank {
   
     
     
    public static void main(String[] args) {
   
     
     
        Account account = new Account(100ï¼Œ "ç»“å©šåŸºé‡‘");
        Drawing you = new Drawing(accountï¼Œ 50ï¼Œ "å±•å ‚");
        Drawing girlfriend = new Drawing(accountï¼Œ 100ï¼Œ "sad");
        you.start();
        girlfriend.start();
    }
}

//è´¦æˆ·
class Account {
   
     
     
    int money;//ä½™é¢
    String cardName;//å¡å

    public Account(int moneyï¼Œ String cardName) {
   
     
     
        this.money = money;
        this.cardName = cardName;
    }
}

//é“¶è¡Œ:æ¨¡æ‹Ÿå–æ¬¾
class Drawing extends Thread {
   
     
     
    Account account;//è´¦æˆ·
    int drawingMoney;//å–é‡‘é¢
    int nowMoney;//ä½ æ‰‹é‡Œçš„é’±

    public Drawing(Account accountï¼Œ int drawingMoneyï¼Œ String name) {
   
     
     
        super(name);
        this.account = account;
        this.drawingMoney = drawingMoney;
    }

    //å–é’±
    @Override
    public void run() {
   
     
     
        //åˆ¤æ–­æ˜¯å¦æœ‰é’±
        if (account.money - drawingMoney < 0) {
   
     
     
            System.out.println(Thread.currentThread().getName() + "ä½™é¢ä¸è¶³ï¼Œä¸èƒ½è¿›è¡Œå–é’±");
            return;
        }
        try {
   
     
     
            Thread.sleep(1000);//æ”¾å¤§é—®é¢˜çš„å‘ç”Ÿæ€§
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }
        //å¡å†…é‡‘é¢ = ä½™é¢-ä½ çš„é’±
        account.money = account.money - drawingMoney;
        //ä½ æ‰‹é‡Œçš„é’±
        nowMoney = nowMoney + drawingMoney;
        System.out.println(account.cardName + "ä½™é¢ä¸º:" + account.money);
        //this.getName()==Thread.currentThread().getName()
        System.out.println(this.getName() + "æ‰‹é‡Œçš„é’±:" + nowMoney);
    }
}
```

```java
//çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆ
public class Demo26_UnsafeList {
   
     
     
    public static void main(String[] args) {
   
     
     
        List<String> list = new ArrayList<String>();
        for (int i = 0; i < 1000; i++) {
   
     
     
            new Thread(()->{
   
     
     
                list.add(Thread.currentThread().getName());
            }).start();
        }
        System.out.println(list.size());
    }
}
```

### ğŸ’3.åŒæ­¥æ–¹æ³• 

![pic_48ff7e9c.png](juc.assets/pic_48ff7e9c.png)  
![pic_5474934e.png](juc.assets/pic_5474934e.png)  
åŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯this

#### å®ç°: 

```java
//å®‰å…¨ä¹°ç¥¨
public class Demo27_SafeBuyTicket {
   
     
     
    public static void main(String[] args) {
   
     
     
        BuyTicket1 buyTicket = new BuyTicket1();
        new Thread(buyTicketï¼Œ "å¼ ä¸‰").start();
        new Thread(buyTicketï¼Œ "æå››").start();
        new Thread(buyTicketï¼Œ "ç‹äº”").start();
    }
}

class BuyTicket1 implements Runnable {
   
     
     
    //ç¥¨
    private int ticketNums = 10;
    boolean flag = true;

    @Override
    public void run() {
   
     
     
        //ä¹°ç¥¨
        while (flag) {
   
     
     
            try {
   
     
     
                buy();
            } catch (Exception e) {
   
     
     
                e.printStackTrace();
            }
        }
    }

    //synchronized åŒæ­¥æ–¹æ³•ï¼Œé”çš„æ˜¯this
    private synchronized void buy() {
   
     
     
        //åˆ¤æ–­æ˜¯å¦æœ‰ç¥¨
        if (ticketNums <= 0) {
   
     
     
            flag = false;
            return;
        }
        //å»¶è¿Ÿ
        try {
   
     
     
            Thread.sleep(1);
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }

        //ä¹°ç¥¨
        System.out.println(Thread.currentThread().getName() + "æ‹¿åˆ°" + ticketNums--);
    }
}
```

### ğŸ’4.åŒæ­¥å— 

![pic_0e1dfd45.png](juc.assets/pic_0e1dfd45.png)  
é”çš„å¯¹è±¡å°±æ˜¯å˜é‡çš„é‡ï¼Œéœ€è¦å¢åˆ æ”¹æŸ¥çš„å¯¹è±¡

#### å®ç°: 

```java
/**
 * å®‰å…¨çš„å–é’± åŒæ­¥å—
 */
public class Demo28_SafeBank {
   
     
     
    public static void main(String[] args) {
   
     
     
        Account1 account = new Account1(100ï¼Œ "ç»“å©šåŸºé‡‘");
        Drawing1 you = new Drawing1(accountï¼Œ 50ï¼Œ "å±•å ‚");
        Drawing1 girlfriend = new Drawing1(accountï¼Œ 100ï¼Œ "sad");
        you.start();
        girlfriend.start();
    }
}

//è´¦æˆ·
class Account1 {
   
     
     
    int money;//ä½™é¢
    String cardName;//å¡å

    public Account1(int moneyï¼Œ String cardName) {
   
     
     
        this.money = money;
        this.cardName = cardName;
    }
}

//é“¶è¡Œ:æ¨¡æ‹Ÿå–æ¬¾
class Drawing1 extends Thread {
   
     
     
    Account1 account;//è´¦æˆ·
    int drawingMoney;//å–é‡‘é¢
    int nowMoney;//ä½ æ‰‹é‡Œçš„é’±

    public Drawing1(Account1 accountï¼Œ int drawingMoneyï¼Œ String name) {
   
     
     
        super(name);
        this.account = account;
        this.drawingMoney = drawingMoney;
    }

    //å–é’±
    @Override
    public void run() {
   
     
     
        //é”çš„å¯¹è±¡å°±æ˜¯å˜é‡çš„é‡ï¼Œéœ€è¦å¢åˆ æ”¹æŸ¥çš„å¯¹è±¡
        synchronized (account) {
   
     
     
            //åˆ¤æ–­æ˜¯å¦æœ‰é’±
            if (account.money - drawingMoney < 0) {
   
     
     
                System.out.println(Thread.currentThread().getName() + "ä½™é¢ä¸è¶³ï¼Œä¸èƒ½è¿›è¡Œå–é’±");
                return;
            }
            try {
   
     
     
                Thread.sleep(1000);//æ”¾å¤§é—®é¢˜çš„å‘ç”Ÿæ€§
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
            //å¡å†…é‡‘é¢ = ä½™é¢-ä½ çš„é’±
            account.money = account.money - drawingMoney;
            //ä½ æ‰‹é‡Œçš„é’±
            nowMoney = nowMoney + drawingMoney;
            System.out.println(account.cardName + "ä½™é¢ä¸º:" + account.money);
            //this.getName()==Thread.currentThread().getName()
            System.out.println(this.getName() + "æ‰‹é‡Œçš„é’±:" + nowMoney);
        }
    }
```

```java
//çº¿ç¨‹å®‰å…¨çš„é›†åˆ åŒæ­¥å—
public class Demo29_SafeList {
   
     
     
    public static void main(String[] args) {
   
     
     
        List<String> list = new ArrayList<String>();
        for (int i = 0; i < 1000; i++) {
   
     
     
            new Thread(() -> {
   
     
     
                synchronized (list) {
   
     
     
                    list.add(Thread.currentThread().getName());
                }
            }).start();
        }
        try {
   
     
     
            Thread.sleep(300);
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }
        System.out.println(list.size());
    }
}
```

JUCå®‰å…¨é›†åˆç±»å‹æ‰©å……

```java
//æµ‹è¯•JUCå®‰å…¨ç±»å‹çš„é›†åˆ
public class Demo30_ThreadJuc {
   
     
     
    public static void main(String[] args) {
   
     
     
        CopyOnWriteArrayList<String> list = new CopyOnWriteArrayList<String>();
        for (int i = 0; i < 10000; i++) {
   
     
     
            new Thread(() -> {
   
     
     
                list.add(Thread.currentThread().getName());
            }).start();
        }
        try {
   
     
     
            Thread.sleep(3000);
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }
        System.out.println(list.size());
    }
}
```

### ğŸ’5.æ­»é” 

![pic_787eb4cc.png](juc.assets/pic_787eb4cc.png)

#### æ¡ˆä¾‹: 

```java
/**
 * æ­»é”:å¤šä¸ªçº¿ç¨‹äº’ç›¸æŠ±ç€å¯¹æ–¹éœ€è¦çš„èµ„æºï¼Œç„¶åå½¢æˆåƒµæŒ
 * è§£å†³:ä¸€ä¸ªé”åªé”ä¸€ä¸ªå¯¹è±¡
 */
class Demo31_DeadLock {
   
     
     
    public static void main(String[] args) {
   
     
     
        Makeup makeup = new Makeup(0ï¼Œ "ç°å§‘å¨˜");
        Makeup makeup1 = new Makeup(1ï¼Œ "ç™½é›ªå…¬ä¸»");
        makeup.start();
        makeup1.start();
    }
}

//å£çº¢
class Lipstick {
   
     
      }
//é•œå­
class Mirror {
   
     
      }

class Makeup extends Thread {
   
     
     
    //éœ€è¦çš„èµ„æºåªæœ‰ä¸€ä»½ï¼Œç”¨staticä¿è¯åªæœ‰ä¸€ä»½
    static Lipstick lipstick = new Lipstick();
    static Mirror mirror = new Mirror();
    int choice;//é€‰æ‹©
    String girlName;//ä½¿ç”¨åŒ–å¦†å“çš„äºº

    public Makeup(int choiceï¼Œ String girlName) {
   
     
     
        this.choice = choice;
        this.girlName = girlName;
    }

    @Override
    public void run() {
   
     
     
        //åŒ–å¦†
        try {
   
     
     
            makeup();
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }
    }

    private void makeup() throws InterruptedException {
   
     
     
        if (choice == 0) {
   
     
     
            synchronized (lipstick) {
   
     
     //è·å¾—å£çº¢çš„é”
                System.out.println(this.girlName + "è·å¾—å£çº¢çš„é”");
                Thread.sleep(1000);
                synchronized (mirror) {
   
     
     //ä¸€ç§’é’Ÿåæƒ³è·å¾—é•œå­
                    System.out.println(this.girlName + "è·å¾—é•œå­çš„é”");
                }
            }
        } else {
   
     
     
            synchronized (mirror) {
   
     
     //è·å¾—å£çº¢é•œå­
                System.out.println(this.girlName + "è·å¾—é•œå­çš„é”");
                Thread.sleep(2000);
                synchronized (lipstick) {
   
     
     //äºŒç§’é’Ÿåæƒ³è·å¾—çš„é”
                    System.out.println(this.girlName + "è·å¾—å£çº¢çš„é”");
                }
            }
        }
    }
}
```

è§£å†³:

```java
/**
 * æ­»é”:å¤šä¸ªçº¿ç¨‹äº’ç›¸æŠ±ç€å¯¹æ–¹éœ€è¦çš„èµ„æºï¼Œç„¶åå½¢æˆåƒµæŒ
 * è§£å†³:ä¸€ä¸ªé”åªé”ä¸€ä¸ªå¯¹è±¡
 */
class Demo31_DeadLock {
   
     
     
    public static void main(String[] args) {
   
     
     
        Makeup makeup = new Makeup(0ï¼Œ "ç°å§‘å¨˜");
        Makeup makeup1 = new Makeup(1ï¼Œ "ç™½é›ªå…¬ä¸»");
        makeup.start();
        makeup1.start();
    }
}

//å£çº¢
class Lipstick {
   
     
      }
//é•œå­
class Mirror {
   
     
      }

class Makeup extends Thread {
   
     
     
    //éœ€è¦çš„èµ„æºåªæœ‰ä¸€ä»½ï¼Œç”¨staticä¿è¯åªæœ‰ä¸€ä»½
    static Lipstick lipstick = new Lipstick();
    static Mirror mirror = new Mirror();
    int choice;//é€‰æ‹©
    String girlName;//ä½¿ç”¨åŒ–å¦†å“çš„äºº

    public Makeup(int choiceï¼Œ String girlName) {
   
     
     
        this.choice = choice;
        this.girlName = girlName;
    }

    @Override
    public void run() {
   
     
     
        //åŒ–å¦†
        try {
   
     
     
            makeup();
        } catch (InterruptedException e) {
   
     
     
            e.printStackTrace();
        }
    }

    private void makeup() throws InterruptedException {
   
     
     
        if (choice == 0) {
   
     
     
            synchronized (lipstick) {
   
     
     //è·å¾—å£çº¢çš„é”
                System.out.println(this.girlName + "è·å¾—å£çº¢çš„é”");
                Thread.sleep(1000);
            }
            synchronized (mirror) {
   
     
     //ä¸€ç§’é’Ÿåæƒ³è·å¾—é•œå­
                System.out.println(this.girlName + "è·å¾—é•œå­çš„é”");
            }
        } else {
   
     
     
            synchronized (mirror) {
   
     
     //è·å¾—å£çº¢é•œå­
                System.out.println(this.girlName + "è·å¾—é•œå­çš„é”");
                Thread.sleep(2000);
            }
            synchronized (lipstick) {
   
     
     //äºŒç§’é’Ÿåæƒ³è·å¾—çš„é”
                System.out.println(this.girlName + "è·å¾—å£çº¢çš„é”");
            }
        }
    }
}
```

#### æ­»é”é¿å…åŠæ³• 

![pic_9ca8168b.png](juc.assets/pic_9ca8168b.png)

### ğŸ’6.Lock(é”) 

![pic_d39eee3c.png](juc.assets/pic_d39eee3c.png)  
![pic_3fb5a222.png](juc.assets/pic_3fb5a222.png)

#### å®ç° 

```java
//æµ‹è¯•Locké”
public class Demo32_ThreadLock {
   
     
     
    public static void main(String[] args) {
   
     
     
        TestLock testLock = new TestLock();
        new Thread(testLock).start();
        new Thread(testLock).start();
        new Thread(testLock).start();
    }
}

class TestLock implements Runnable {
   
     
     
    int tickerNums = 10;
    //å®šä¹‰Locké”
    private final ReentrantLock lock = new ReentrantLock();

    @Override
    public void run() {
   
     
     
        while (true) {
   
     
     
            //åŠ é”
            try {
   
     
     
                lock.lock();
                if (tickerNums <= 0) {
   
     
     
                    break;
                }
                try {
   
     
     
                    Thread.sleep(1000);
                } catch (InterruptedException e) {
   
     
     
                    e.printStackTrace();
                }
                System.out.println(tickerNums--);
            } catch (Exception e) {
   
     
     
                e.printStackTrace();
            } finally {
   
     
     
                //è§£é”
                lock.unlock();
            }
        }
    }
}
```

### ğŸ’7.synchroizedä¸Lockå¯¹æ¯” 

![pic_0019087d.png](juc.assets/pic_0019087d.png)

## äº”ã€çº¿ç¨‹é€šä¿¡é—®é¢˜ 

ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼çš„é—®é¢˜  
![pic_4968058b.png](juc.assets/pic_4968058b.png)

### ğŸ’1.çº¿ç¨‹é€šä¿¡æ–¹æ³• 

![pic_eb467d2b.png](juc.assets/pic_eb467d2b.png)  
![pic_f6772bdd.png](juc.assets/pic_f6772bdd.png)

### ğŸ’2.çº¿ç¨‹é€šä¿¡é—®é¢˜è§£å†³æ–¹å¼ 

![pic_f1f83864.png](juc.assets/pic_f1f83864.png)

```java
/**
 * æµ‹è¯•:ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹-->åˆ©ç”¨ç¼“å†²åŒºè§£å†³:ç®¡ç¨‹æ³•
 */
public class Demo33_ThreadPC {
   
     
     
    public static void main(String[] args) {
   
     
     
        SynContainer synContainer = new SynContainer();
        new Producer(synContainer).start();
        new Consumer(synContainer).start();
    }
}

//ç”Ÿäº§è€…
class Producer extends Thread {
   
     
     
    //å®¹ç¼“å†²åŒº
    SynContainer container;

    public Producer(SynContainer container) {
   
     
     
        this.container = container;
    }

    //ç”Ÿäº§
    @Override
    public void run() {
   
     
     
        for (int i = 0; i < 100; i++) {
   
     
     
            container.push(new Product(i));
            System.out.println("ç”Ÿäº§äº†" + i + "ä»¶äº§å“");
        }
    }
}

//æ¶ˆè´¹è€…
class Consumer extends Thread {
   
     
     
    //å®¹ç¼“å†²åŒº
    SynContainer container;

    public Consumer(SynContainer container) {
   
     
     
        this.container = container;
    }

    //æ¶ˆè´¹
    @Override
    public void run() {
   
     
     
        for (int i = 0; i < 100; i++) {
   
     
     
            System.out.println("æ¶ˆè´¹äº†-->" + container.pop().id + "ä»¶äº§å“");
        }
    }
}

//äº§å“
class Product {
   
     
     
    int id;//äº§å“ç¼–å·

    public Product(int id) {
   
     
     
        this.id = id;
    }
}

//ç¼“å†²åŒº
class SynContainer {
   
     
     
    //éœ€è¦ä¸€ä¸ªå®¹å™¨å¤§å°
    Product[] products = new Product[10];
    //å®¹å™¨è®¡æ•°å™¨
    int count = 0;

    //ç”Ÿäº§è€…æ”¾å…¥äº§å“
    public synchronized void push(Product product) {
   
     
     
        //å¦‚æœå®¹å™¨æ»¡äº†ï¼Œéœ€è¦ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹
        /*å¦‚æœæ˜¯ifçš„è¯ï¼Œå‡å¦‚æ¶ˆè´¹è€…1æ¶ˆè´¹äº†æœ€åä¸€ä¸ªï¼Œè¿™æ˜¯indexå˜æˆ0æ­¤æ—¶é‡Šæ”¾é”è¢«æ¶ˆè´¹è€…2æ‹¿åˆ°è€Œä¸æ˜¯ç”Ÿäº§è€…æ‹¿åˆ°ï¼Œè¿™æ—¶æ¶ˆè´¹è€…çš„waitæ˜¯åœ¨ifé‡Œæ‰€ä»¥å®ƒå°±ç›´æ¥å»æ¶ˆè´¹index-1ä¸‹æ ‡è¶Šç•Œï¼Œå¦‚æœæ˜¯whileå°±ä¼šå†å»åˆ¤æ–­ä¸€ä¸‹indexå¾—å€¼æ˜¯ä¸æ˜¯å˜æˆ0äº†*/
        while (count == products.length) {
   
     
     
            //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç­‰å¾…ç”Ÿäº§
            try {
   
     
     
                this.wait();
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
        }
        //å¦‚æœæ²¡æœ‰æ»¡ï¼Œéœ€è¦ä¸¢å…¥äº§å“
        products[count] = product;
        count++;
        //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹
        this.notifyAll();
    }

    //æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“
    public synchronized Product pop() {
   
     
     
        //åˆ¤æ–­æ˜¯å¦èƒ½æ¶ˆè´¹
        while (count <= 0) {
   
     
     
            //ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§
            try {
   
     
     
                this.wait();
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
        }
        //å¦‚æœå¯ä»¥æ¶ˆè´¹
        count--;
        Product product = products[count];
        //åƒå®Œäº† é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§
        this.notifyAll();
        return product;
    }
}
```

![pic_ebbff628.png](juc.assets/pic_ebbff628.png)

```java
/**
 * æµ‹è¯•:ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å‹-->åˆ©ç”¨ç¼“å†²åŒºè§£å†³:ç®¡ç¨‹æ³•
 */
public class Demo33_ThreadPC {
   
     
     
    public static void main(String[] args) {
   
     
     
        SynContainer synContainer = new SynContainer();
        new Producer(synContainer).start();
        new Consumer(synContainer).start();
    }
}

//ç”Ÿäº§è€…
class Producer extends Thread {
   
     
     
    //å®¹ç¼“å†²åŒº
    SynContainer container;

    public Producer(SynContainer container) {
   
     
     
        this.container = container;
    }

    //ç”Ÿäº§
    @Override
    public void run() {
   
     
     
        for (int i = 0; i < 100; i++) {
   
     
     
            container.push(new Product(i));
            System.out.println("ç”Ÿäº§äº†" + i + "ä»¶äº§å“");
        }
    }
}

//æ¶ˆè´¹è€…
class Consumer extends Thread {
   
     
     
    //å®¹ç¼“å†²åŒº
    SynContainer container;

    public Consumer(SynContainer container) {
   
     
     
        this.container = container;
    }

    //æ¶ˆè´¹
    @Override
    public void run() {
   
     
     
        for (int i = 0; i < 100; i++) {
   
     
     
            System.out.println("æ¶ˆè´¹äº†-->" + container.pop().id + "ä»¶äº§å“");
        }
    }
}

//äº§å“
class Product {
   
     
     
    int id;//äº§å“ç¼–å·

    public Product(int id) {
   
     
     
        this.id = id;
    }
}

//ç¼“å†²åŒº
class SynContainer {
   
     
     
    //éœ€è¦ä¸€ä¸ªå®¹å™¨å¤§å°
    Product[] products = new Product[10];
    //å®¹å™¨è®¡æ•°å™¨
    int count = 0;

    //ç”Ÿäº§è€…æ”¾å…¥äº§å“
    public synchronized void push(Product product) {
   
     
     
        //å¦‚æœå®¹å™¨æ»¡äº†ï¼Œéœ€è¦ç­‰å¾…æ¶ˆè´¹è€…æ¶ˆè´¹
        /*å¦‚æœæ˜¯ifçš„è¯ï¼Œå‡å¦‚æ¶ˆè´¹è€…1æ¶ˆè´¹äº†æœ€åä¸€ä¸ªï¼Œè¿™æ˜¯indexå˜æˆ0æ­¤æ—¶é‡Šæ”¾é”è¢«æ¶ˆè´¹è€…2æ‹¿åˆ°è€Œä¸æ˜¯ç”Ÿäº§è€…æ‹¿åˆ°ï¼Œè¿™æ—¶æ¶ˆè´¹è€…çš„waitæ˜¯åœ¨ifé‡Œæ‰€ä»¥å®ƒå°±ç›´æ¥å»æ¶ˆè´¹index-1ä¸‹æ ‡è¶Šç•Œï¼Œå¦‚æœæ˜¯whileå°±ä¼šå†å»åˆ¤æ–­ä¸€ä¸‹indexå¾—å€¼æ˜¯ä¸æ˜¯å˜æˆ0äº†*/
        while (count == products.length) {
   
     
     
            //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹ï¼Œç­‰å¾…ç”Ÿäº§
            try {
   
     
     
                this.wait();
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
        }
        //å¦‚æœæ²¡æœ‰æ»¡ï¼Œéœ€è¦ä¸¢å…¥äº§å“
        products[count] = product;
        count++;
        //é€šçŸ¥æ¶ˆè´¹è€…æ¶ˆè´¹
        this.notifyAll();
    }

    //æ¶ˆè´¹è€…æ¶ˆè´¹äº§å“
    public synchronized Product pop() {
   
     
     
        //åˆ¤æ–­æ˜¯å¦èƒ½æ¶ˆè´¹
        while (count <= 0) {
   
     
     
            //ç­‰å¾…ç”Ÿäº§è€…ç”Ÿäº§
            try {
   
     
     
                this.wait();
            } catch (InterruptedException e) {
   
     
     
                e.printStackTrace();
            }
        }
        //å¦‚æœå¯ä»¥æ¶ˆè´¹
        count--;
        Product product = products[count];
        //åƒå®Œäº† é€šçŸ¥ç”Ÿäº§è€…ç”Ÿäº§
        this.notifyAll();
        return product;
    }
}
```

## å…­ã€çº¿ç¨‹æ±  

![pic_7671d40a.png](juc.assets/pic_7671d40a.png)  
![pic_94619b73.png](juc.assets/pic_94619b73.png)

```java
//æµ‹è¯•çº¿ç¨‹æ± 
public class Demo35_ThreadPool {
   
     
     
    public static void main(String[] args) {
   
     
     
        // 1. åˆ›å»ºæœåŠ¡ï¼Œæ“¦è¡Œé—´çº¿ç¨‹æ± 
        // newFixedThreadPool(çº¿ç¨‹æ± å¤§å°)
        ExecutorService service = Executors.newFixedThreadPool(10);
        //æ‰§è¡Œ
        service.execute(new MyThread());
        service.execute(new MyThread());
        service.execute(new MyThread());
        service.execute(new MyThread());
        service.execute(new MyThread());
        service.execute(new MyThread());
        //å…³é—­è¿æ¥
        service.shutdown();
    }
}

class MyThread implements Runnable {
   
     
     
    @Override
    public void run() {
   
     
     
        System.out.println(Thread.currentThread().getName());
    }
}
```
